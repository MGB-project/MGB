{% load static %}
{% load book_tags %}

<div class="book-card">
  <a href="{% url 'book_detail' item.id %}" class="book-link">
      {% if item.custom_header_photo %}
        <div class="book-bg" style="background: url({{ item.custom_header_photo }});">
      {% else %}
        <div class="book-bg" style="background: url({{ item.thumbnail }});">
      {% endif %}

      {% if item.user_rating is not None %}
        {% with urating=item.user_rating %}
            {% if urating >= 8 %}
                <span class="rating" style="background-color: #15B000;">
                {{ item.user_rating }}
                </span>
            {% elif urating >= 5 %}
                <span class="rating" style="background-color: #FFFF00;">
                {{ item.user_rating }}
                </span>
            {% elif urating > 1 %}
                <span class="rating" style="background-color: #FF4949;">
                {{ item.user_rating }}
                </span>
            {% else %}
                <span class="rating" style="background-color: #B7485C;">
                {{ item.user_rating }}
                </span>
            {% endif %}
        {% endwith %}
      {% else %}
        <span class="rating">?</span>
      {% endif %}
    </div>
  </a>

  <div class="card-information">
    <h2>{% if item.title|length > 23 %}
      {{ item.title|slice:":20" }}...
    {% else %}
      {{ item.title }}
    {% endif %}</h2>
    <div class="runtime">
      <span>Страниц 2222</span>
    </div>
    <div class="genres-date-added">
      <div class="item-genres">
        <h3>Жанры:</h3>
        <span class="genre">
          {% for genre in item.categories %}
            {{ item.categories|join:", " }}
          {% endfor %}
        </span>
      </div>
      <div class="item-date-release">
        <h3>Дата выпуска:</h3>
        <span class="date-release">
          {% if item.published_date %}
            {{ item.published_date }}
          {% else %}
            <p>No</p>
          {% endif %}
        </span>
      </div>
      <div class="item-date-added">
        <h3>Дата добавления</h3>
        <span class="date-release">
          {{ item.latest_interaction_date|date:"d M. Y" }}
        </span>
      </div>
    </div>
  </div>
</div>